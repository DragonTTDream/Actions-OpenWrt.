echo "libblkid-dev" >> result.txt
echo "e2fsprogs" >> result.txt
curl -fsSL git.io/depends-ubuntu-2004 >> result.txt
curl -fsSL https://is.gd/depends_ubuntu_2204 >> result.txt
sort -u result.txt | xargs sudo apt-get install

sudo apt-get update
sudo -i apt upgrade

sudo apt-get install lib32gcc-s1

sudo apt install git
#git clone https://github.com/coolsnowwolf/lede
#cd lede
#克隆breakings/OpenWrt/trunk/general目录
#svn export https://github.com/breakings/OpenWrt/trunk/general
#还需要修改DIY脚本中的$GITHUB_WORKSPACE为$(pwd)
git clone  https://github.com/1715173329/imoutowrt
cd imoutowrt

#- name: Load custom feeds

./scripts/feeds update -a
./scripts/feeds install -a

sudo apt install subversion
chmod +x DIY.sh
./DIY.sh
./scripts/feeds update -a
./scripts/feeds install -a

#- name: Load custom configuration
sudo apt install make

sudo apt-get install gcc 
sudo apt-get install g++ 
sudo apt-get install gawk
sudo apt-get install python3-distutils
sudo apt-get install libncurses-dev

make menuconfig

make -j8 download V=s

make -j$(nproc) ||  make -j1 V=s
#生成结果将生成到目录。bin/targets


mkdir -p opt/kernel
cd opt/kernel
curl -LJO https://github.com/breakings/OpenWrt/raw/main/opt/kernel/5.15.98/*
cd /opt
git clone https://github.com/unifreq/openwrt_packit
ln -s /home/loong/immortalwrt/bin/targets/armvirt/64/openwrt-armvirt-64-default-rootfs.tar.gz /home/loong/immortalwrt/opt/openwrt_packit/openwrt-armvirt-64-default-rootfs.tar.gz

